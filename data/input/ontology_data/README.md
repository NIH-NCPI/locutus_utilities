# Reference Data Files

This directory contains static reference data files. Notes about each, below.

## Files

### `locutus_system_map.csv`

- **Purpose**: Provides a mapping from standardized ontology codes (e.g., LNC, OMIM) to their corresponding `system` URIs or identifiers. Locutus will fetch this csv on deployment and use it as a lookup and also validation. Renamed to ftd_ontology_lookup.csv in Locutus.
- **Structure**:
  - `curie`: A short string representing the ontology (e.g., `"LNC"` for LOINC). The column name 'curie' is used loosely. In some cases it is a known variant of the curie, or a prefix of the ontology itself, etc.
  - `system`: The corresponding full URI or identifier (e.g., `"http://loinc.org"`).
  - Additional columns may be added in the future to enrich the metadata.

## Notes

- Subject to change: This data is read into memory at application startup to support fast ontology code lookups for API calls.
- Manual additions (e.g., alternative forms like `LOINC` or `MeSH`) are injected into the lookup table at runtime to ensure robust mapping.

## Maintenance

- Subject to change: To update this file, run the `$ utils_run -p locutus-dev -o update_ontology_api -a update_csv` command. This command updates the csv precursors to this csv before recreating this csv.
- Precursers `manual_ontology_transformations` and `ontology_api`.  <br>
- You could add new system mappings manually, by editting `ontology_api_etl/add_manual_additions_to_ontology_lookup`. This method is outdated, but is still viable.


### `included_ontologies.csv`

- **Purpose**: Designates the ontologies expected by Locutus and returned by MapDragon search functions. Used for several functions mainly used as a lookup for the OntologyAPI Collection creation. 
- **Structure**:
  - `Default to Include`: Designates ontologies on the 'short list'. If necessary, this field can be used to filter down the ontologies sent to MapDragon as viable search ontologies. See 'Maintenance' section for info about how that is used.

## Notes

- Source was a file generated by running `analysis/analyse_ontology_data.py` then brought to the team for 'short list' creation as a google doc. [Link](https://docs.google.com/spreadsheets/d/1hSZKmE40H7blaCYx5WmZdDZ_BdP6hM84eCG6Z2aVYTk/edit?gid=0#gid=0). 

## Maintenance

- Edit manually when an ontology is missing from the list. Edits will be brought to the maintainers attention.
- To apply the short_code filter, run the `$ utils_run -p locutus-dev -o update_ontology_api` with the additional commands listed in the root dir README.md. 

### `manual_ontology_transformations.csv`

- **Purpose**: Edit/add ontology data manually. Most ontology data is retrieved from the ontology apis(ols, umls). These are not always consistant with thier data(lacking systems, or 'curies').

## Notes

- Source is manually updated. Check the following google sheet for any additions or edits from the team. `locutus_utils_version` tab from the google sheet. [Link](https://docs.google.com/spreadsheets/d/1Fq94B47ZR1Gz6p48SI9T_WGizOmyi5lYEDRZ1KpY42s/edit?gid=1597334219#gid=1597334219). Keep both the csv and Google Sheet up to date manually.

## Maintenance

- Edit manually when an ontology is missing from the list. Edits will be brought to the maintainers attention via Jira tickets.


### `ontology_api.csv`

- **Purpose**: Generated by ontology_api_etl.py this aggregates as much of the manual transformations of ontology data as possible from the different sources of ontology data and manual transformations.
    - Requires included_ontologies
    - manual_additions - ontology_api_etl.py
    - manual_ontology_transformations.py

## Maintenance

- Reginerated by running ontology_api_etl.py. See root dir README.md for more.

